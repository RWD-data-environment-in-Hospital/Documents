<!DOCTYPE html>
<html>
<head>
<title>WhiteRabbit 操作手順</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.4/css/all.css">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 16px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

p, li, pre {
	width: 90%; max-width: 1200px;
}

pre code {
	color: var(--vscode-editor-foreground);
	font-size: 16px;
	tab-size: 4;
}

■img横幅調整無効
/* img {
	max-width: 100%;
	max-height: 100%;
} */

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

/* ページトップへ移動ボタン */
#page_top{
  width: 90px;
  height: 90px;
  position: fixed;
  right: 15px;
  bottom: 15px;
  background: #3f98ef;
  opacity: 0.6;
  border-radius: 50%;
}
#page_top a{
  position: relative;
  display: block;
  width: 90px;
  height: 90px;
  text-decoration: none;
}
#page_top a::before{
  font-family: 'Font Awesome 5 Free';
  font-weight: 900;
  content: '\f102';
  font-size: 25px;
  color: #fff;
  position: absolute;
  width: 25px;
  height: 25px;
  top: -40px;
  bottom: 0;
  right: 0;
  left: 0;
  margin: auto;
  text-align: center;
}
#page_top a::after{
  content: 'PAGE TOP';
  font-size: 13px;
  color: #fff;
  position: absolute;
  top: 45px;
  bottom: 0;
  right: 0;
  left: 0;
  margin: auto;
  text-align: center;
}

html{
  scroll-behavior: smooth;
}
/* ------------------------------ */
table {
  border-collapse: collapse;
  width:1200px
}

table th{
	color: #ffffffc4;
	background: #4b4b4b;
	/* background: #003142; */
	border: solid 1px #4d4d4c;
}

table td {
	border: solid 1px #4d4d4c;
}
</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<div id="page_top"><a href="#"></a></div>
<h1 id="white-rabbitrabbit-in-a-hat-%E6%93%8D%E4%BD%9C%E6%89%8B%E9%A0%86"><strong>White Rabbit、Rabbit-in-a-Hat 操作手順</strong></h1>
<h2 id="%E7%9B%AE%E6%AC%A1"><strong>目次</strong></h2>
<p><a href="#1%E6%9C%AC%E6%89%8B%E9%A0%86%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6">1．本手順について</a></p>
<p><a href="#2white-rabbitrabbit-in-a-hat%E3%81%AE%E9%96%A2%E4%BF%82%E5%9B%B3">2．White Rabbit、Rabbit-in-a-Hat の関係図</a></p>
<p><a href="#3white-rabbit">3．White Rabbit</a></p>
<ul>
<li><a href="#31%E6%93%8D%E4%BD%9C%E3%81%AE%E6%B5%81%E3%82%8C">3．1．操作の流れ</a></li>
<li><a href="#32%E6%93%8D%E4%BD%9C%E6%89%8B%E9%A0%86">3．2．操作手順</a>
<ul>
<li><a href="#321%E5%BF%85%E9%A0%88%E3%83%87%E3%83%BC%E3%82%BF%E3%83%99%E3%83%BC%E3%82%B9or%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E9%81%B8%E6%8A%9E">3．2．1．【必須】データベース or テキストファイル選択</a></li>
<li><a href="#322%E5%BF%85%E9%A0%88%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E9%81%B8%E6%8A%9E">3．2．2．【必須】読み込みデータの選択</a></li>
<li><a href="#323%E5%BF%85%E9%A0%88%E3%83%87%E3%83%BC%E3%82%BFscan-report%E3%81%AE%E5%87%BA%E5%8A%9B">3．2．3．【必須】データ（Scan report）の出力</a></li>
<li><a href="#324%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%B9%E3%82%AD%E3%83%A3%E3%83%B3%E6%9D%A1%E4%BB%B6%E3%81%AE%E8%A8%AD%E5%AE%9A">3．2．4．【オプション】スキャン条件の設定</a></li>
<li><a href="#325%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3fake-data-generation">3．2．5．【オプション】Fake data generation</a></li>
</ul>
</li>
</ul>
<p><a href="#4rabbit-in-a-hat">4．Rabbit-in-a-Hat</a></p>
<ul>
<li><a href="#41%E6%93%8D%E4%BD%9C%E3%81%AE%E6%B5%81%E3%82%8C">4．1．操作の流れ</a></li>
<li><a href="#42%E6%93%8D%E4%BD%9C%E6%89%8B%E9%A0%86">4．2．操作手順</a>
<ul>
<li><a href="#421%E5%BF%85%E9%A0%88scan-report%E3%81%AE%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF">4．2．1．【必須】Scan report の読み込み</a></li>
<li><a href="#422%E5%BF%85%E9%A0%88%EF%BD%83%EF%BD%84%EF%BD%8D%E3%81%AE%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E9%81%B8%E6%8A%9E">4．2．2．【必須】CDM のバージョン選択</a></li>
<li><a href="#423%E5%BF%85%E9%A0%88%E3%83%9E%E3%83%83%E3%83%94%E3%83%B3%E3%82%B0">4．2．3．【必須】マッピング</a>
<ul>
<li>1．テーブル間マッピング</li>
<li>2．テーブル内の項目間マッピング</li>
</ul>
</li>
<li><a href="#424%E5%BF%85%E9%A0%88%E3%83%87%E3%83%BC%E3%82%BF%E5%87%BA%E5%8A%9B">4．2．4．【必須】データ出力</a></li>
</ul>
</li>
<li><a href="#43%E5%8F%82%E8%80%83%E6%A9%9F%E8%83%BD%E7%B4%B9%E4%BB%8B">4．3．【参考】機能紹介</a>
<ul>
<li><a href="#431mark-highlighted-as-complete">4．3．1．Mark Highlighted As Complete</a></li>
<li><a href="#432discard-value-counts">4．3．2．Discard Value Counts</a></li>
<li><a href="#433stem-table">4．3．3．Stem table</a></li>
<li><a href="#434cdm%E3%81%AE%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%9E%E3%82%A4%E3%82%BA">4．3．4．CDM のカスタマイズ</a></li>
</ul>
</li>
</ul>
<br>
<hr>
<h1 id="1%E6%9C%AC%E6%89%8B%E9%A0%86%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"><strong>1．本手順について</strong></h1>
<p>White Rabbit、Rabbit-in-a-Hat を操作するための手順について説明します。<br>
本操作手順は、以下の環境が準備されていることを前提としています。</p>
<ul>
<li>Windows10（64ビット）</li>
<li>Java（バージョン1.8以降）</li>
<li><a href="https://github.com/OHDSI/WhiteRabbit/releases/tag/v0.10.3" target="_blank" rel="nofollow noopener"><ins>White Rabbit のインストール</ins></a></li>
</ul>
<br>
<hr>
<h1 id="2white-rabbitrabbit-in-a-hat%E3%81%AE%E9%96%A2%E4%BF%82%E5%9B%B3"><strong>2．White Rabbit、Rabbit-in-a-Hat の関係図</strong></h1>
<p>入力ソースデータは、電子カルテデータになります。<br>
OMOP CDM の各リソースへマッピング支援するのが、Rabbit-in-a-Hat です。<br>
Rabbit-in-a-Hat でマッピング作業を進めるために、White Rabbit では入力データを Rabbi-in-a-Hat で取り込み可能な形式に加工します。</p>
<p><img src="./WhiteRabbit_2/image/image28.png" alt=""></p>
<br>
<hr>
<h1 id="3white-rabbit"><strong>3．White Rabbit</strong></h1>
<hr>
<h2 id="31%E6%93%8D%E4%BD%9C%E3%81%AE%E6%B5%81%E3%82%8C"><strong>3．1．操作の流れ</strong></h2>
<p>操作の流れを以下に示します。</p>
<p><img src="./WhiteRabbit_2/image/image27.png" alt=""></p>
<br>
<hr>
<h2 id="32%E6%93%8D%E4%BD%9C%E6%89%8B%E9%A0%86"><strong>3．2．操作手順</strong></h2>
<p>White Rabbit の操作方法について説明します。<br>
データ出力において必要な操作には【必須】、任意の操作には【オプション】と記載しています。</p>
<br>
<hr>
<h3 id="321%E5%BF%85%E9%A0%88%E3%83%87%E3%83%BC%E3%82%BF%E3%83%99%E3%83%BC%E3%82%B9or%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E9%81%B8%E6%8A%9E"><strong>3．2．1．【必須】データベース or テキストファイル選択</strong></h3>
<p>Rabbit-in-a-Hat に入力するデータと出力されるデータについて、設定を実施します。</p>
<p><strong>入力データ</strong><br>
［Locations］タブを開き、［Working Folder］の［Source data location］で、データを読み込むためのセッティングを実施します。</p>
<p>［Data type］では、データの形式（データベース、またはテキストファイル）（①）を選択します。<br>
CSV ファイルを読み込ませる場合、「Delimited text files」を選択してください。<br>
［Data type］にてデータベースを選択した場合は、
サーバーの場所（②）、ユーザー名（③）、パスワード（④）、データベース名（⑤）を入力し、［Test Connection］ボタン（⑥）をクリックします。</p>
<p>接続に成功すると⑦のメッセージが表示されます。</p>
<p><img src="./WhiteRabbit_2/image/image2.png" alt="" width="1200px">
<img src="./WhiteRabbit_2/image/image3.png" alt=""></p>
<br>
<p><strong>出力データ</strong><br>
［Locations］タブを開き、［Working Folder］の［Pick folder］ボタンをクリックし、生成されるファイル（Scan report）の格納先フォルダーを選択します。</p>
<p><img src="./WhiteRabbit_2/image/image4.png" alt=""  width="1200px"></p>
<br>
<p>以上でデータベース or テキストファイルの選択作業は終了です。</p>
<br>
<hr>
<h2 id="322%E5%BF%85%E9%A0%88%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E9%81%B8%E6%8A%9E"><strong>3．2．2．【必須】読み込みデータの選択</strong></h2>
<p>Rabbit-in-a-Hat でマッピングしたいデータの選択を実施します。<br>
［Scan］タブを開きます。<br>
［Tables to scan］では、Scan report を作成したいテーブル・ファイルを選択、条件設定をします。</p>
<p>3．2．1 でデータベース接続を選択した場合は、</p>
<ul>
<li>［Add all in DB］ボタン（①）で、選択したデータベースの全テーブルを追加することができます。</li>
<li>［Add］ボタン（②）で、データベース内のテーブルを選択して追加することができます。</li>
<li>［Remove］ボタン（③）で、追加済みのテーブルを選択して削除することができます。</li>
</ul>
<p>3．2．1でテキストファイルを選択した場合は、</p>
<ul>
<li>［Add］ボタン（②）を押し、ローカルに保存されたテキストファイルを選択して追加することができます。</li>
<li>［Remove］ボタン（③）で、追加済みのテーブルを選択して削除することができます。</li>
</ul>
<p><img src="./WhiteRabbit_2/image/image5.png" alt="" width="1200px"></p>
<br>
<hr>
<h2 id="323%E5%BF%85%E9%A0%88%E3%83%87%E3%83%BC%E3%82%BFscan-report%E3%81%AE%E5%87%BA%E5%8A%9B"><strong>3．2．3．【必須】データ（Scan report）の出力</strong></h2>
<p>［Scan tables］ボタン（①）を選択すると追加したテーブルが読み込まれ、読み込みが成功するとコンソールに Scan report generated と表示されます。（②）<br>
3．2．1 で指定したファルダに、「ScanReport.xlsx」が生成されています。</p>
<p><img src="./WhiteRabbit_2/image/image6.png" alt="" width="1200px"></p>
<br>
<hr>
<h2 id="324%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%B9%E3%82%AD%E3%83%A3%E3%83%B3%E6%9D%A1%E4%BB%B6%E3%81%AE%E8%A8%AD%E5%AE%9A"><strong>3．2．4．【オプション】スキャン条件の設定</strong></h2>
<p>読み込みデータを選択後、出力データ（Scan report）の形式を設定したい場合に［Scan field values］にチェックを入れることで、下記の項目に関して設定が可能です。<br>
チェックを入れなかった場合は出力データに生データの項目が表示されなくなり、Rabbit-in-a-Hat 上の操作でも生データの情報は表示されなくなります。<br>
Rabbit-in-a-Hat で生データの情報を確認しながらマッピングしたい場合は、こちらの条件設定を実施する必要があります。</p>
<table>
<thead>
<tr>
<th style="text-align:left" width="200px">条件（英語）</th>
<th style="text-align:left" width="220px">条件（日本語）</th>
<th style="text-align:left">実行内容</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Min cell count</td>
<td style="text-align:left">最小セル数（①）</td>
<td style="text-align:left">ソースデータ数が設定値以上のときデータ値をレポートに表示、設定値未満の場合はtruncatedと表示</td>
</tr>
<tr>
<td style="text-align:left">Max distinctvalues</td>
<td style="text-align:left">最大個別値（②）</td>
<td style="text-align:left">設定した数の個別の値がスキャンレポートに表示、設定値未満の値は表示されず、truncatedが表示</td>
</tr>
<tr>
<td style="text-align:left">Rows per table</td>
<td style="text-align:left">テーブル当たりの行数（③）</td>
<td style="text-align:left">テーブル内の設定数行の値の並びがランダム化</td>
</tr>
<tr>
<td style="text-align:left">Numeric stats</td>
<td style="text-align:left">数値統計（④）</td>
<td style="text-align:left">平均、標準偏差、最小値、四分位数、最大値を、すべての整数、実数、日付のデータ型に対して統計実施</td>
</tr>
<tr>
<td style="text-align:left">Numeric stats reservoir size</td>
<td style="text-align:left">数値統計保有サイズ（⑤）</td>
<td style="text-align:left">統計実施可能なデータ数</td>
</tr>
</tbody>
</table>
<p><img src="./WhiteRabbit_2/image/image7.png" alt="" width="1200px"></p>
<br>
<hr>
<h2 id="325%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3fake-data-generation"><strong>3．2．5．【オプション】Fake data generation</strong></h2>
<p>Fake data generation では、テストデータを作成することができます。<br>
3．2．3 で生成された「ScanReport.xlsx」を読み込むことで、元のソースデータの値がランダムに並べられたソースデータが生成されます。</p>
<p><img src="./WhiteRabbit_2/image/image8.png" alt="" width="1200px"></p>
<p>White Rabbit での作業説明は以上です。</p>
<br>
<hr>
<h1 id="4rabbit-in-a-hat"><strong>4．Rabbit-in-a-Hat</strong></h1>
<hr>
<h2 id="41%E6%93%8D%E4%BD%9C%E3%81%AE%E6%B5%81%E3%82%8C"><strong>4．1．操作の流れ</strong></h2>
<p>Rabbit-in-a-Hat の操作の流れを以下に示します。</p>
<p><img src="./WhiteRabbit_2/image/image26.png" alt=""></p>
<p>本手順では、CDM Version6.0 の person テーブルとのマッピングを例に挙げて操作説明を進めていきます。</p>
<br>
<hr>
<h2 id="42%E6%93%8D%E4%BD%9C%E6%89%8B%E9%A0%86"><strong>4．2．操作手順</strong></h2>
<p>Rabbit-in-a-Hat の操作方法について説明します。
マッピングにおいて必要な操作には【必須】、任意の操作には【オプション】と記載しています。</p>
<br>
<hr>
<h3 id="421%E5%BF%85%E9%A0%88scan-report%E3%81%AE%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF"><strong>4．2．1．【必須】Scan reportの読み込み</strong></h3>
<p>［File］タブの［Open Scan Report］（①）から、White Rabbit で生成された「ScanReport.xlsx」を選択します。<br>
選択後、ファイルが読み込まれて左側の［Source］に White Rabbit で読み込んだデータのテーブル名がオレンジ色の箱に表示されます。（②）</p>
<br>
<p><strong>＜読み込み前＞</strong>
<img src="./WhiteRabbit_2/image/image9.png" alt="" width="1200px"></p>
<br>
<p><strong>＜読み込み後＞</strong>
<img src="./WhiteRabbit_2/image/image10.png" alt="" width="1200px"></p>
<br>
<hr>
<h3 id="422%E5%BF%85%E9%A0%88%EF%BD%83%EF%BD%84%EF%BD%8D%E3%81%AE%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E9%81%B8%E6%8A%9E"><strong>4．2．2．【必須】CDM のバージョン選択</strong></h3>
<p>［Edit］タブの［Set Target Database］（①）より、CDM のバージョンを選択可能することができます。<br>
本手順では、CDM v6.0 を選択します。（デフォルトですでに設定されています）</p>
<p><img src="./WhiteRabbit_2/image/image11.png" alt="" width="1200px"></p>
<br>
<hr>
<h3 id="423%E5%BF%85%E9%A0%88%E3%83%9E%E3%83%83%E3%83%94%E3%83%B3%E3%82%B0"><strong>4．2．3．【必須】マッピング</strong></h3>
<p>テーブル・項目を関連づけるために矢印を使って箱同士を結び付けます。箱はドラッグアンドドロップで移動することができます。</p>
<p>マッピングには2種類あります。</p>
<ul>
<li>1．テーブル間マッピング</li>
<li>2．テーブル内の項目間マッピング</li>
</ul>
<hr>
<p><strong>1．テーブル間マッピング</strong><br>
Source テーブルにカーソルを合わせると矢印が表示されます。（①）<br>
関連づけたい CDM のテーブルに向けて矢印を移動し、つなげる（②）ことでマッピングができます。<br>
矢印は1つのソーステーブルから複数の CDM テーブルに対して接続可能です。<br>
また、複数のテーブルから1つの CDM のテーブルに接続することも可能です。</p>
<p>person と patient_profile を矢印でつなぎマッピングをします。</p>
<p><img src="./WhiteRabbit_2/image/image12.png" alt="" width="1200px"></p>
<br>
<p>矢印をクリックすると、マッピング画面の右側に［Detail］欄が表示されます。<br>
ここでは、ソーステーブル（Scan report）とターゲットテーブル（CDM）が表示される（③）ほか Logic（④）にはマッピングに関するロジックに関する伝達事項、Comments（⑤）には特記事項がある場合に自由に記載可能です。</p>
<p><img src="./WhiteRabbit_2/image/image13.png" alt="" width="1200px"></p>
<br>
<p>箱をクリックすると、マッピング画面右側に［Details］欄が表示され、各テーブルの詳細情報が記載されています。<br>
テーブル名（⑥）、テーブルの行数（⑦）、項目名（⑧）、項目のデータ型（⑨）を確認することができます。</p>
<p>画面下には［Comments］欄（⑩）があり、記載事項があれば記入することが可能です。</p>
<p><img src="./WhiteRabbit_2/image/image14.png" alt="" width="1200px"></p>
<br>
<hr>
<p><strong>2．テーブル内の項目間マッピング</strong><br>
1でマッピングした矢印をダブルクリックすると、双方のテーブルの各項目が表示されます。（①）</p>
<p><img src="./WhiteRabbit_2/image/image15.png" alt="" width="1200px"></p>
<br>
<p>下図のように各項目をマッピングしていきます。<br>
マッピングの方法は、1と同様の操作です。（見えやすくするために、箱は初期位置から移動させています。）</p>
<p>&lt; patient_profile と person の項目間のマッピング&gt;
<img src="./WhiteRabbit_2/image/image16.png" alt="" width="1200px"></p>
<br>
<p>項目の箱をクリックするとマッピング画面右側に［Details］欄が表示されて、詳細情報を確認することができます。</p>
<p>項目名（②）、データ型（③）、データの固有値（④）、生データ（⑤）が表示されます。
下部には［Comments］欄（⑥）があり、特記事項があれば記入することが可能です。</p>
<p><img src="./WhiteRabbit_2/image/image17.png" alt="" width="1200px"></p>
<p>以上で patient_profile テーブルと person テーブルのマッピング操作は終了です。</p>
<br>
<hr>
<h3 id="424%E5%BF%85%E9%A0%88%E3%83%87%E3%83%BC%E3%82%BF%E5%87%BA%E5%8A%9B"><strong>4．2．4．【必須】データ出力</strong></h3>
<p>マッピングしたデータを出力する場合は、［File］タブの［Save As］をクリックし（①）、任意の場所にGZIP形式で保存（②）します。</p>
<p><img src="./WhiteRabbit_2/image/image18.png" alt="" width="1200px"></p>
<br>
<p>［File］タブの［Open ETL specs］（①）から GZIP ファイルを開くことで（②）、マッピング処理が保持された状態で再開することができます。（③）</p>
<p><img src="./WhiteRabbit_2/image/image19.png" alt="" width="1200px"></p>
<br>
<p>他にも、必要に応じて以下のデータを出力することができます。</p>
<table>
<thead>
<tr>
<th style="text-align:left">ドキュメントの種類</th>
<th style="text-align:left">概要</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">ETL Document（①）</td>
<td style="text-align:left">テーブル間マッピング図表、テーブル内項目マッピング図表を Word、HTML、Markdown 形式で出力</td>
</tr>
<tr>
<td style="text-align:left">Overview Table（②）</td>
<td style="text-align:left">各テーブルのテーブル名、データ型などの詳細情報を CSV 形式で出力</td>
</tr>
<tr>
<td style="text-align:left">ETL TestFramework（③）</td>
<td style="text-align:left">ETL プロセスが指定どおりに機能していることを確認するためのテストフレームワーク（Ｒ）を出力</td>
</tr>
<tr>
<td style="text-align:left">SQL Skeleton Files（④）</td>
<td style="text-align:left">各テーブルの SQL データ</td>
</tr>
</tbody>
</table>
<p><img src="./WhiteRabbit_2/image/image20.png" alt="" width="1200px"></p>
<hr>
<h2 id="43%E5%8F%82%E8%80%83%E6%A9%9F%E8%83%BD%E7%B4%B9%E4%BB%8B"><strong>4．3．【参考】機能紹介</strong></h2>
<p>Rabbit-in-a-Hat で使用できる機能を紹介します。<br>
必須機能ではありません。</p>
<br>
<hr>
<h3 id="431mark-highlighted-as-complete"><strong>4．3．1．Mark Highlighted As Complete</strong></h3>
<p>矢印の色を変えて、マッピングが完了しているか否かを判別できるようにするものです。<br>
矢印をクリックして選択後（①）に［Arrows］タブの［Mark Highlighted As Complete］をクリック（②）します。<br>
処理を実施した矢印の色が変化して、他と差別化可能（③）となります。<br>
［Mark Highlighted As Incomplete］（④）で元の色の矢印に戻すことが可能です。</p>
<p><img src="./WhiteRabbit_2/image/image21.png" alt="" width="1200px"></p>
<br>
<hr>
<h3 id="432discard-value-counts"><strong>4．3．2．Discard Value Counts</strong></h3>
<p>ソースデータの集計値や CDM の項目内のコンセプト情報を破棄します。<br>
テーブル名をダブルクリックしてテーブル内の項目を選択後、［Edit］タブの［Discard Value Counts］（①）をクリックすると、［Value Counts］欄に表示されていた集計値が消えます。（②）</p>
<p>この処理を実施したデータを保存した場合、破棄状態も保持されます。</p>
<p><img src="./WhiteRabbit_2/image/image22.png" alt="" width="1200px"></p>
<br>
<hr>
<h3 id="433stem-table"><strong>4．3．3．Stem table</strong></h3>
<p>ある Source テーブルが複数の CDM テーブルにマッピングする必要がある場合に、Stem table を使用することでマッピングを繰り返す手間がなくなり、実装を容易にすることが可能になります。<br>
しかし、Stem table 内の項目は CDM のバージョンごとに決まっており、CDM へのマッピング先の追加はできません。<br>
また、項目同士のマッピングについて不明瞭な点があること、Stem table 省力化のための機能であることから現段階では、使用する必要はないと考えられます。<br>
使用方法を以下に記載します。<br>
［Edit］タブの［Add stem table］を選択する（①）と、紫色の stem_table の箱が tables 画面の中央上部に表示されます。（②）<br>
デフォルトでは、図に示されるように7つのテーブルに接続済みです。（③）</p>
<p><img src="./WhiteRabbit_2/image/image23.png" alt="" width="1200px"></p>
<br>
<hr>
<h3 id="434cdm%E3%81%AE%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%9E%E3%82%A4%E3%82%BA"><strong>4．3．4．CDMのカスタマイズ</strong></h3>
<p>CDM は下図に示されるバージョンのほかに、カスタマイズすることも可能です。<br>
カスタマイズするためには、github 上に共有されている「CDMV5.csv」の形式に則った CSV ファイルを作成する必要があります。</p>
<p>[Edit]タブの[Set Target Database]（①）から[Load custom...]（②）を選択し、作成した新たな CDM ファイルを選択します。<br>
このとき、ファイル名が CDM 名として表示されます。（③）</p>
<p><img src="./WhiteRabbit_2/image/image24.png" alt="" width="1200px"></p>
<br>
<p>&lt;CDMV5 の形式に従って作成した CDM_custom&gt;
<img src="./WhiteRabbit_2/image/image1.png" alt="" width="1200px">
<img src="./WhiteRabbit_2/image/image25.png" alt="" width="1200px"></p>
<br>
<br>
<br>
<br>
<br>
</body>
</html>
